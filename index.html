<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ArogyaSakhi - AI-Assisted Cervical Cancer Detection</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #ffffff 0%, #f1f9ff 100%);
            padding: 0.75rem 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-bottom: 3px solid #0ea5e9;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #0ea5e9, #14b8a6);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
        }
        
        .logo-title {
            font-size: 20px;
            font-weight: 700;
            color: #0f172a;
            margin: 0;
        }
        
        .logo-subtitle {
            font-size: 11px;
            color: #64748b;
            margin: 0;
            display: none;
        }
        
        .nav-menu {
            display: none;
            gap: 1rem;
            list-style: none;
        }
        
        .nav-item {
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
        }
        
        .nav-item:hover {
            background-color: #e0f2fe;
            color: #0369a1;
        }
        
        .nav-item.active {
            background-color: #0ea5e9;
            color: white;
        }
        
        .user-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .mobile-menu-btn {
            display: block;
            background: none;
            border: none;
            font-size: 20px;
            color: #64748b;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }
        
        .mobile-menu-btn:hover {
            background: #f1f5f9;
            color: #0ea5e9;
        }
        
        /* Mobile Menu */
        .mobile-menu {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .mobile-menu.show {
            display: flex;
        }
        
        .mobile-menu-content {
            background: white;
            width: 280px;
            height: 100%;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            padding: 1rem;
        }
        
        .mobile-menu.show .mobile-menu-content {
            transform: translateX(0);
        }
        
        .mobile-menu-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .mobile-nav-items {
            list-style: none;
        }
        
        .mobile-nav-items .nav-item {
            display: block;
            padding: 12px 16px;
            margin-bottom: 4px;
            border-radius: 8px;
        }
        
        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .card:hover {
            box-shadow: 0 4px 25px rgba(0,0,0,0.1);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .card-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            flex-shrink: 0;
        }
        
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: #0f172a;
        }
        
        /* Upload Panel */
        .upload-panel {
            grid-column: 1 / -1;
        }
        
        .upload-icon {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
        }
        
        .upload-area {
            border: 2px dashed #94a3b8;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f9ff 100%);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .upload-area:hover {
            border-color: #0ea5e9;
            background: linear-gradient(135deg, #f1f9ff 0%, #e0f2fe 100%);
        }
        
        .upload-area.dragover {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%);
            transform: scale(1.01);
        }
        
        .upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
        }
        
        .upload-text {
            text-align: center;
        }
        
        .upload-title {
            font-size: 18px;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 6px;
        }
        
        .upload-subtitle {
            color: #64748b;
            margin-bottom: 16px;
            font-size: 14px;
        }
        
        .image-preview {
            width: 120px;
            height: 120px;
            background: linear-gradient(45deg, #1f2937, #374151);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            font-size: 12px;
            text-align: center;
            border: 3px solid #4b5563;
            overflow: hidden;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-preview.has-image {
            border-color: #10b981;
            background: #d5f4e6;
        }
        
        /* File Information Display */
        .file-info {
            margin-top: 12px;
            padding: 10px;
            background: #e8f4fd;
            border-radius: 6px;
            border-left: 3px solid #0ea5e9;
            display: none;
        }
        
        .file-info.show {
            display: block;
        }
        
        .file-name {
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 3px;
            font-size: 14px;
            word-break: break-all;
        }
        
        .file-details {
            font-size: 11px;
            color: #64748b;
            line-height: 1.4;
        }
        
        /* Error and Success Messages */
        .message {
            margin-top: 10px;
            padding: 10px;
            border-radius: 6px;
            display: none;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }
        
        .message.show {
            display: flex;
        }
        
        .message.error {
            background: #fef2f2;
            color: #dc2626;
            border-left: 3px solid #ef4444;
        }
        
        .message.success {
            background: #f0fdfa;
            color: #059669;
            border-left: 3px solid #10b981;
        }
        
        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            touch-action: manipulation;
            user-select: none;
            min-height: 40px;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            box-shadow: 0 3px 15px rgba(14, 165, 233, 0.3);
        }
        
        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #cbd5e1;
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: #e2e8f0;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .btn-success:hover:not(:disabled) {
            box-shadow: 0 3px 15px rgba(16, 185, 129, 0.3);
        }
        
        .btn-group {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: none;
            margin-top: 16px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }
        
        .action-buttons.show {
            display: block;
        }
        
        .action-buttons .btn-group {
            justify-content: center;
            margin-top: 0;
        }
        
        /* AI Processing */
        .processing-icon {
            background: linear-gradient(135deg, #14b8a6, #059669);
        }
        
        .progress-container {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        .progress-circle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: conic-gradient(#14b8a6 0deg, #e2e8f0 0deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .progress-circle::before {
            content: '';
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            position: absolute;
        }
        
        .progress-text {
            position: relative;
            font-weight: 600;
            color: #14b8a6;
            z-index: 1;
            font-size: 14px;
        }
        
        .processing-info {
            flex: 1;
            min-width: 0;
        }
        
        .processing-title {
            font-size: 16px;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 3px;
        }
        
        .processing-subtitle {
            color: #64748b;
            margin-bottom: 10px;
            font-size: 13px;
        }
        
        .status-indicators {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: #14b8a6;
        }
        
        /* Results */
        .results-icon {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f1f5f9;
            gap: 8px;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 500;
            color: #374151;
            font-size: 13px;
            flex-shrink: 0;
        }
        
        .result-value {
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            text-align: right;
            word-break: break-word;
        }
        
        .result-normal {
            background: #dcfce7;
            color: #166534;
        }
        
        .result-abnormal {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .result-warning {
            background: #fef3c7;
            color: #d97706;
        }
        
        /* Camera Modal */
        .camera-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .camera-modal.show {
            display: flex;
        }
        
        .camera-content {
            background: white;
            border-radius: 12px;
            padding: 16px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .camera-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .camera-title {
            font-size: 16px;
            font-weight: 600;
            color: #0f172a;
        }
        
        .close-camera {
            background: none;
            border: none;
            font-size: 20px;
            color: #64748b;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .close-camera:hover {
            background: #f1f5f9;
            color: #ef4444;
        }
        
        .camera-container {
            position: relative;
            background: #1f2937;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 16px;
        }
        
        #cameraVideo {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
        }
        
        #captureCanvas {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: none;
        }
        
        .camera-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            display: none;
        }
        
        .camera-overlay.show {
            display: block;
        }
        
        .camera-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 80px;
            right: 1rem;
            background: white;
            border-radius: 10px;
            padding: 12px 16px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.15);
            border-left: 3px solid #10b981;
            z-index: 1001;
            display: none;
            align-items: center;
            gap: 10px;
            max-width: calc(100vw - 2rem);
            animation: slideIn 0.3s ease-out;
        }
        
        .notification.show {
            display: flex;
        }
        
        .notification.error {
            border-left-color: #ef4444;
        }
        
        .notification.warning {
            border-left-color: #f59e0b;
        }
        
        .notification.info {
            border-left-color: #0ea5e9;
        }
        
        .notification-content {
            flex: 1;
            min-width: 0;
        }
        
        .notification-title {
            font-weight: 600;
            font-size: 13px;
            color: #0f172a;
        }
        
        .notification-message {
            font-size: 12px;
            color: #64748b;
            margin-top: 2px;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }
        
        .processing-active {
            animation: pulse 2s infinite;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 1.5rem 1rem;
            margin-top: 1.5rem;
            border-top: 2px solid #e2e8f0;
            color: #64748b;
            font-size: 13px;
        }
        
        .footer p {
            margin-bottom: 4px;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Desktop Responsive Design */
        @media (min-width: 768px) {
            .header {
                padding: 1rem 2rem;
            }
            
            .logo-icon {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
            
            .logo-title {
                font-size: 24px;
            }
            
            .logo-subtitle {
                display: block;
                font-size: 12px;
            }
            
            .nav-menu {
                display: flex;
                gap: 2rem;
            }
            
            .nav-item {
                padding: 8px 16px;
                font-size: 15px;
            }
            
            .mobile-menu-btn {
                display: none;
            }
            
            .main-container {
                padding: 2rem;
                grid-template-columns: 1fr 1fr;
                gap: 2rem;
            }
            
            .card {
                padding: 24px;
            }
            
            .card:hover {
                transform: translateY(-2px);
            }
            
            .card-header {
                margin-bottom: 20px;
                padding-bottom: 16px;
                gap: 12px;
            }
            
            .card-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .card-title {
                font-size: 18px;
            }
            
            .upload-area {
                padding: 40px;
                min-height: 250px;
            }
            
            .upload-content {
                flex-direction: row;
                gap: 30px;
            }
            
            .upload-text {
                text-align: left;
            }
            
            .upload-title {
                font-size: 24px;
                margin-bottom: 8px;
            }
            
            .upload-subtitle {
                margin-bottom: 20px;
                font-size: 15px;
            }
            
            .image-preview {
                width: 140px;
                height: 140px;
                font-size: 14px;
            }
            
            .btn {
                padding: 12px 24px;
                font-size: 14px;
            }
            
            .btn-group {
                gap: 12px;
                margin-top: 16px;
            }
            
            .progress-container {
                gap: 20px;
                margin-bottom: 20px;
            }
            
            .progress-circle {
                width: 80px;
                height: 80px;
            }
            
            .progress-circle::before {
                width: 60px;
                height: 60px;
            }
            
            .processing-title {
                font-size: 18px;
                margin-bottom: 4px;
            }
            
            .processing-subtitle {
                margin-bottom: 12px;
                font-size: 14px;
            }
            
            .status-indicators {
                gap: 16px;
            }
            
            .status-item {
                font-size: 13px;
            }
            
            .result-item {
                padding: 12px 0;
            }
            
            .result-label {
                font-size: 14px;
            }
            
            .result-value {
                font-size: 12px;
                padding: 4px 12px;
            }
            
            .camera-content {
                max-width: 600px;
                padding: 24px;
            }
            
            .camera-title {
                font-size: 20px;
            }
            
            #cameraVideo,
            #captureCanvas {
                height: 300px;
            }
            
            .notification {
                top: 20px;
                min-width: 300px;
            }
            
            .notification-title {
                font-size: 14px;
            }
            
            .notification-message {
                font-size: 13px;
            }
        }
        
        @media (min-width: 1024px) {
            .upload-content {
                justify-content: space-between;
            }
        }
        
        /* iOS specific fixes */
        @supports (-webkit-appearance: none) {
            .btn {
                -webkit-appearance: none;
                border-radius: 6px;
            }
            
            input[type="file"] {
                -webkit-appearance: none;
            }
        }
        
        /* Android specific fixes */
        @media screen and (-webkit-min-device-pixel-ratio: 0) {
            .upload-area {
                touch-action: manipulation;
            }
        }
        
        /* High DPI displays */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .card {
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-heartbeat"></i>
                </div>
                <div class="logo-text">
                    <h1 class="logo-title">ArogyaSakhi</h1>
                    <p class="logo-subtitle">AI-Powered Healthcare Assistant</p>
                </div>
            </div>
            
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item active">Dashboard</li>
                    <li class="nav-item">Analysis</li>
                    <li class="nav-item">History</li>
                    <li class="nav-item">Reports</li>
                    <li class="nav-item">Settings</li>
                </ul>
            </nav>
            
            <div class="user-actions">
                <button class="btn btn-secondary">
                    <i class="fas fa-user"></i>
                    <span class="hidden" style="display: none;">Profile</span>
                </button>
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-content">
            <div class="mobile-menu-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <div class="logo-text">
                        <h1 class="logo-title">ArogyaSakhi</h1>
                    </div>
                </div>
                <button class="close-camera" id="closeMobileMenu">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <ul class="mobile-nav-items">
                <li class="nav-item active">Dashboard</li>
                <li class="nav-item">Analysis</li>
                <li class="nav-item">History</li>
                <li class="nav-item">Reports</li>
                <li class="nav-item">Settings</li>
                <li class="nav-item">Profile</li>
            </ul>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Upload Panel -->
        <div class="card upload-panel">
            <div class="card-header">
                <div class="card-icon upload-icon">
                    <i class="fas fa-upload"></i>
                </div>
                <h2 class="card-title">Upload Medical Image</h2>
            </div>
            
            <div class="upload-area" id="uploadArea">
                <div class="upload-content">
                    <div class="upload-text">
                        <h3 class="upload-title">Drag & Drop or Click to Upload</h3>
                        <p class="upload-subtitle">
                            Support for JPEG, PNG, DICOM files<br>
                            Maximum file size: 10MB
                        </p>
                        <div class="btn-group">
                            <button class="btn btn-primary" id="selectFileBtn">
                                <i class="fas fa-file-medical"></i>
                                Select File
                            </button>
                            <button class="btn btn-secondary" id="takePictureBtn">
                                <i class="fas fa-camera"></i>
                                Camera
                            </button>
                        </div>
                    </div>
                    <div class="image-preview" id="imagePreview">
                        <i class="fas fa-image" style="font-size: 28px;"></i><br>
                        No image selected
                    </div>
                </div>
                
                <input type="file" id="fileInput" accept="image/*,.dcm,.dicom,application/dicom" style="display: none;">
                
                <!-- File Information -->
                <div class="file-info" id="fileInfo">
                    <div class="file-name" id="fileName">No file selected</div>
                    <div class="file-details" id="fileDetails">Select an image or DICOM file to see details</div>
                </div>
                
                <!-- Messages -->
                <div class="message error" id="errorMessage">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span id="errorText">Error message will appear here</span>
                </div>
                
                <div class="message success" id="successMessage">
                    <i class="fas fa-check-circle"></i>
                    <span id="successText">Success message will appear here</span>
                </div>
                
                <!-- Action Buttons -->
                <div class="action-buttons" id="actionButtons">
                    <div class="btn-group">
                        <button class="btn btn-success" id="analyzeBtn">
                            <i class="fas fa-brain"></i>
                            Start AI Analysis
                        </button>
                        <button class="btn btn-secondary" id="clearBtn">
                            <i class="fas fa-trash"></i>
                            Clear Image
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Processing -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon processing-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h2 class="card-title">AI Analysis</h2>
            </div>
            
            <div class="progress-container">
                <div class="progress-circle" id="progressCircle">
                    <span class="progress-text" id="progressText">0%</span>
                </div>
                <div class="processing-info">
                    <h3 class="processing-title" id="processingTitle">Ready for Analysis</h3>
                    <p class="processing-subtitle" id="processingSubtitle">Upload an image to begin AI processing</p>
                    <div class="status-indicators" id="statusIndicators">
                        <div class="status-item">
                            <i class="fas fa-circle" style="color: #e2e8f0;"></i>
                            <span>Waiting for input</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="btn btn-primary" id="startAnalysisBtn" disabled>
                <i class="fas fa-play"></i>
                Start Analysis
            </button>
        </div>

        <!-- Analysis Results -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon results-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <h2 class="card-title">Analysis Results</h2>
            </div>
            
            <div id="resultsContent">
                <div class="result-item">
                    <span class="result-label">Overall Assessment</span>
                    <span class="result-value result-normal" id="overallResult">Pending Analysis</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Cervical chances</span>
                    <span class="result-value result-normal" id="confidenceResult">-</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Risk Factors</span>
                    <span class="result-value result-normal" id="riskResult">-</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Recommendation</span>
                    <span class="result-value result-normal" id="recommendationResult">Upload image first</span>
                </div>
            </div>
            
            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-primary" id="downloadReportBtn">
                    <i class="fas fa-download"></i>
                    <span class="hidden" style="display: inline;">Download </span>Report
                </button>
                <button class="btn btn-secondary" id="shareReportBtn">
                    <i class="fas fa-share"></i>
                    <span class="hidden" style="display: inline;">Share </span>Results
                </button>
            </div>
        </div>

        <!-- Patient Information -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                    <i class="fas fa-user-md"></i>
                </div>
                <h2 class="card-title">Patient Information</h2>
            </div>
            
            <div class="result-item">
                <span class="result-label">Patient ID</span>
                <span class="result-value" style="background: #f3f4f6; color: #374151;">AS-2025-001</span>
            </div>
            <div class="result-item">
                <span class="result-label">Age</span>
                <span class="result-value" style="background: #f3f4f6; color: #374151;">35 years</span>
            </div>
            <div class="result-item">
                <span class="result-label">Last Screening</span>
                <span class="result-value" style="background: #f3f4f6; color: #374151;">6 months ago</span>
            </div>
            <div class="result-item">
                <span class="result-label">Risk Category</span>
                <span class="result-value result-normal">Low Risk</span>
            </div>
            
            <button class="btn btn-secondary" style="margin-top: 16px; width: 100%;">
                <i class="fas fa-edit"></i>
                Edit Patient Info
            </button>
        </div>
    </div>

    <!-- Camera Modal -->
    <div class="camera-modal" id="cameraModal">
        <div class="camera-content">
            <div class="camera-header">
                <h3 class="camera-title">Capture Medical Image</h3>
                <button class="close-camera" id="closeCameraBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="camera-container">
                <video id="cameraVideo" autoplay muted playsinline></video>
                <canvas id="captureCanvas"></canvas>
                <div class="camera-overlay" id="cameraOverlay">
                    <i class="fas fa-camera" style="font-size: 40px; margin-bottom: 10px;"></i>
                    <p>Initializing camera...</p>
                </div>
            </div>
            
            <div class="camera-controls">
                <button class="btn btn-success" id="captureBtn" style="display: none;">
                    <i class="fas fa-camera"></i>
                    Capture
                </button>
                <button class="btn btn-secondary" id="retakeBtn" style="display: none;">
                    <i class="fas fa-redo"></i>
                    Retake
                </button>
                <button class="btn btn-primary" id="usePhotoBtn" style="display: none;">
                    <i class="fas fa-check"></i>
                    Use Photo
                </button>
                <button class="btn btn-secondary" id="cancelCameraBtn">
                    <i class="fas fa-times"></i>
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle" id="notificationIcon"></i>
        <div class="notification-content">
            <div class="notification-title" id="notificationTitle">Notification</div>
            <div class="notification-message" id="notificationMessage">This is a notification message.</div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 ArogyaSakhi. Empowering healthcare through AI technology.</p>
        <p style="margin-top: 8px;">
            <strong>Disclaimer:</strong> This tool is for screening purposes only. Always consult healthcare professionals for medical advice.
        </p>
    </footer>

    <script>
        // Global variables
        let currentStream = null;
        let capturedImageData = null;
        let selectedFile = null;
        let analysisInProgress = false;
        let touchStartY = 0;
        let touchEndY = 0;

        // DOM elements
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const selectFileBtn = document.getElementById('selectFileBtn');
        const takePictureBtn = document.getElementById('takePictureBtn');
        const imagePreview = document.getElementById('imagePreview');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileDetails = document.getElementById('fileDetails');
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        const actionButtons = document.getElementById('actionButtons');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const clearBtn = document.getElementById('clearBtn');

        // Mobile menu elements
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        const closeMobileMenu = document.getElementById('closeMobileMenu');

        // Camera modal elements
        const cameraModal = document.getElementById('cameraModal');
        const cameraVideo = document.getElementById('cameraVideo');
        const captureCanvas = document.getElementById('captureCanvas');
        const cameraOverlay = document.getElementById('cameraOverlay');
        const closeCameraBtn = document.getElementById('closeCameraBtn');
        const captureBtn = document.getElementById('captureBtn');
        const retakeBtn = document.getElementById('retakeBtn');
        const usePhotoBtn = document.getElementById('usePhotoBtn');
        const cancelCameraBtn = document.getElementById('cancelCameraBtn');

        // Processing elements
        const progressCircle = document.getElementById('progressCircle');
        const progressText = document.getElementById('progressText');
        const processingTitle = document.getElementById('processingTitle');
        const processingSubtitle = document.getElementById('processingSubtitle');
        const statusIndicators = document.getElementById('statusIndicators');
        const startAnalysisBtn = document.getElementById('startAnalysisBtn');

        // Results elements
        const overallResult = document.getElementById('overallResult');
        const confidenceResult = document.getElementById('confidenceResult');
        const riskResult = document.getElementById('riskResult');
        const recommendationResult = document.getElementById('recommendationResult');

        // Notification elements
        const notification = document.getElementById('notification');
        const notificationIcon = document.getElementById('notificationIcon');
        const notificationTitle = document.getElementById('notificationTitle');
        const notificationMessage = document.getElementById('notificationMessage');

        // Utility functions for mobile optimization
        function isMobile() {
            return window.innerWidth <= 768 || /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        function preventZoom(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }

        function preventDoubleTapZoom(e) {
            const now = new Date().getTime();
            const timeSince = now - lastTouchEnd;
            if (timeSince < 300 && timeSince > 0) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }

        let lastTouchEnd = 0;

        // Initialize event listeners
        function initializeEventListeners() {
            // Mobile optimization
            if (isMobile()) {
                document.addEventListener('touchstart', preventZoom, { passive: false });
                document.addEventListener('touchend', preventDoubleTapZoom, { passive: false });
                
                // Prevent pull-to-refresh
                document.body.addEventListener('touchstart', e => {
                    if (e.touches.length === 1) {
                        touchStartY = e.touches[0].clientY;
                    }
                });
                
                document.body.addEventListener('touchmove', e => {
                    if (e.touches.length === 1) {
                        touchEndY = e.touches[0].clientY;
                        if (touchStartY <= touchEndY && window.scrollY === 0) {
                            e.preventDefault();
                        }
                    }
                }, { passive: false });
            }

            // Mobile menu events
            mobileMenuBtn.addEventListener('click', openMobileMenu);
            closeMobileMenu.addEventListener('click', closeMobileMenuHandler);
            mobileMenu.addEventListener('click', (e) => {
                if (e.target === mobileMenu) closeMobileMenuHandler();
            });

            // File upload events
            selectFileBtn.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', handleFileSelect);
            
            // Drag and drop events
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleDrop);
            uploadArea.addEventListener('click', (e) => {
                if (e.target === uploadArea || e.target.closest('.upload-content')) {
                    fileInput.click();
                }
            });

            // Camera events
            takePictureBtn.addEventListener('click', openCamera);
            closeCameraBtn.addEventListener('click', closeCamera);
            cancelCameraBtn.addEventListener('click', closeCamera);
            captureBtn.addEventListener('click', captureImage);
            retakeBtn.addEventListener('click', retakePhoto);
            usePhotoBtn.addEventListener('click', usePhoto);

            // Action button events
            analyzeBtn.addEventListener('click', startAnalysis);
            clearBtn.addEventListener('click', clearImage);
            startAnalysisBtn.addEventListener('click', startAnalysis);

            // Navigation events
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    showNotification('info', 'Navigation', `Switched to ${this.textContent}`);
                    if (isMobile()) {
                        closeMobileMenuHandler();
                    }
                });
            });

            // Report actions
            document.getElementById('downloadReportBtn').addEventListener('click', downloadReport);
            document.getElementById('shareReportBtn').addEventListener('click', shareReport);

            // Close modal when clicking outside
            cameraModal.addEventListener('click', (e) => {
                if (e.target === cameraModal) closeCamera();
            });

            // Prevent default drag behaviors
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.addEventListener(eventName, preventDefaults, false);
            });

            // Handle window resize
            window.addEventListener('resize', handleResize);
            
            // Handle orientation change
            window.addEventListener('orientationchange', () => {
                setTimeout(handleResize, 100);
            });
        }

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        function handleResize() {
            // Close mobile menu if screen becomes desktop size
            if (window.innerWidth > 768 && mobileMenu.classList.contains('show')) {
                closeMobileMenuHandler();
            }
            
            // Adjust notification position on orientation change
            if (notification.classList.contains('show')) {
                notification.style.right = '1rem';
                notification.style.maxWidth = 'calc(100vw - 2rem)';
            }
        }

        // Mobile menu functions
        function openMobileMenu() {
            mobileMenu.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeMobileMenuHandler() {
            mobileMenu.classList.remove('show');
            document.body.style.overflow = '';
        }

        // File handling functions
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                processFile(file);
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            if (!uploadArea.contains(event.relatedTarget)) {
                uploadArea.classList.remove('dragover');
            }
        }

        function handleDrop(event) {
            event.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        function processFile(file) {
            // Reset previous messages
            hideMessages();
            
            // Validate file type
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'application/dicom'];
            const allowedExtensions = ['.dcm', '.dicom'];
            
            const isValidType = allowedTypes.includes(file.type) || 
                               allowedExtensions.some(ext => file.name.toLowerCase().endsWith(ext));
            
            if (!isValidType) {
                showError('Please select a valid image file (JPEG, PNG) or DICOM file.');
                return;
            }
            
            // Validate file size (10MB limit)
            const maxSize = 10 * 1024 * 1024; // 10MB
            if (file.size > maxSize) {
                showError('File size exceeds 10MB limit. Please select a smaller file.');
                return;
            }
            
            selectedFile = file;
            displayFileInfo(file);
            
            // Display image preview if it's an image
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    displayImagePreview(e.target.result);
                };
                reader.onerror = function() {
                    showError('Failed to read the selected file.');
                };
                reader.readAsDataURL(file);
            } else {
                // For DICOM files, show a placeholder
                displayDicomPreview();
            }
            
            showSuccess('File uploaded successfully!');
            showActionButtons();
            enableAnalysis();
        }

        function displayFileInfo(file) {
            fileName.textContent = file.name;
            const sizeFormatted = formatFileSize(file.size);
            const typeFormatted = file.type || 'DICOM';
            const dateFormatted = new Date(file.lastModified).toLocaleDateString();
            fileDetails.textContent = `${sizeFormatted} • ${typeFormatted} • ${dateFormatted}`;
            fileInfo.classList.add('show');
        }

        function displayImagePreview(imageSrc) {
            imagePreview.innerHTML = `<img src="${imageSrc}" alt="Selected image">`;
            imagePreview.classList.add('has-image');
        }

        function displayDicomPreview() {
            imagePreview.innerHTML = `
                <i class="fas fa-file-medical" style="font-size: 28px; color: #0ea5e9;"></i><br>
                <span style="color: #0ea5e9; font-weight: 600; font-size: 12px;">DICOM File</span>
            `;
            imagePreview.classList.add('has-image');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        // Camera functions
        async function openCamera() {
            try {
                showNotification('info', 'Camera Access', 'Requesting camera permission...');
                
                const constraints = {
                    video: { 
                        width: { ideal: 1280, max: 1920 }, 
                        height: { ideal: 720, max: 1080 },
                        facingMode: isMobile() ? { ideal: 'environment' } : 'user'
                    }
                };

                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                
                currentStream = stream;
                cameraVideo.srcObject = stream;
                cameraModal.classList.add('show');
                cameraOverlay.classList.add('show');
                
                if (isMobile()) {
                    document.body.style.overflow = 'hidden';
                }
                
                // Hide overlay and show capture button once video is playing
                cameraVideo.addEventListener('loadedmetadata', () => {
                    cameraOverlay.classList.remove('show');
                    captureBtn.style.display = 'inline-flex';
                    showNotification('success', 'Camera Ready', 'Camera is ready for capture!');
                });
                
            } catch (error) {
                console.error('Error accessing camera:', error);
                let errorMsg = 'Unable to access camera.';
                if (error.name === 'NotAllowedError') {
                    errorMsg = 'Camera permission denied. Please enable camera access and try again.';
                } else if (error.name === 'NotFoundError') {
                    errorMsg = 'No camera found on this device.';
                } else if (error.name === 'NotReadableError') {
                    errorMsg = 'Camera is being used by another application.';
                }
                showError(errorMsg);
                showNotification('error', 'Camera Error', errorMsg);
            }
        }

        function closeCamera() {
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
                currentStream = null;
            }
            
            cameraModal.classList.remove('show');
            cameraVideo.srcObject = null;
            captureCanvas.style.display = 'none';
            cameraVideo.style.display = 'block';
            cameraOverlay.classList.add('show');
            
            document.body.style.overflow = '';
            
            // Reset button visibility
            captureBtn.style.display = 'none';
            retakeBtn.style.display = 'none';
            usePhotoBtn.style.display = 'none';
            
            capturedImageData = null;
        }

        function captureImage() {
            const canvas = captureCanvas;
            const video = cameraVideo;
            
            // Set canvas dimensions to match video
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            // Draw the video frame to canvas
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Convert to data URL with high quality
            capturedImageData = canvas.toDataURL('image/jpeg', 0.9);
            
            // Show captured image and update buttons
            video.style.display = 'none';
            canvas.style.display = 'block';
            
            captureBtn.style.display = 'none';
            retakeBtn.style.display = 'inline-flex';
            usePhotoBtn.style.display = 'inline-flex';
            
            showNotification('success', 'Photo Captured', 'Photo captured successfully!');
        }

        function retakePhoto() {
            captureCanvas.style.display = 'none';
            cameraVideo.style.display = 'block';
            
            captureBtn.style.display = 'inline-flex';
            retakeBtn.style.display = 'none';
            usePhotoBtn.style.display = 'none';
            
            capturedImageData = null;
        }

        function usePhoto() {
            if (capturedImageData) {
                // Create a virtual file from the captured image
                selectedFile = dataURLtoFile(capturedImageData, `captured_image_${Date.now()}.jpg`);
                
                displayImagePreview(capturedImageData);
                displayFileInfo(selectedFile);
                
                closeCamera();
                showSuccess('Photo selected successfully!');
                showActionButtons();
                enableAnalysis();
                
                showNotification('success', 'Photo Selected', 'Photo is ready for analysis!');
            }
        }

        function dataURLtoFile(dataurl, filename) {
            const arr = dataurl.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            
            while(n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }
            
            return new File([u8arr], filename, { 
                type: mime,
                lastModified: Date.now()
            });
        }

        // UI helper functions
        function showActionButtons() {
            actionButtons.classList.add('show');
        }

        function hideActionButtons() {
            actionButtons.classList.remove('show');
        }

        function enableAnalysis() {
            startAnalysisBtn.disabled = false;
            analyzeBtn.disabled = false;
            processingTitle.textContent = 'Ready for Analysis';
            processingSubtitle.textContent = 'Image uploaded successfully. Click to start AI analysis.';
            statusIndicators.innerHTML = `
                <div class="status-item">
                    <i class="fas fa-check-circle"></i>
                    <span>Image Ready</span>
                </div>
            `;
        }

        function clearImage() {
            selectedFile = null;
            capturedImageData = null;
            fileInput.value = '';
            
            // Reset preview
            imagePreview.innerHTML = `
                <i class="fas fa-image" style="font-size: 28px;"></i><br>
                No image selected
            `;
            imagePreview.classList.remove('has-image');
            
            // Hide file info and action buttons
            fileInfo.classList.remove('show');
            hideActionButtons();
            hideMessages();
            
            // Reset analysis state
            startAnalysisBtn.disabled = true;
            analyzeBtn.disabled = true;
            processingTitle.textContent = 'Ready for Analysis';
            processingSubtitle.textContent = 'Upload an image to begin AI-powered analysis';
            progressText.textContent = '0%';
            progressCircle.style.background = 'conic-gradient(#14b8a6 0deg, #e2e8f0 0deg)';
            statusIndicators.innerHTML = `
                <div class="status-item">
                    <i class="fas fa-circle" style="color: #e2e8f0;"></i>
                    <span>Waiting for input</span>
                </div>
            `;
            
            // Reset results
            resetResults();
            
            showNotification('info', 'Image Cleared', 'Image cleared. Upload a new image to continue.');
        }

        function resetResults() {
            overallResult.textContent = 'Pending Analysis';
            overallResult.className = 'result-value result-normal';
            confidenceResult.textContent = '-';
            riskResult.textContent = '-';
            recommendationResult.textContent = 'Upload image first';
        }

        // Analysis functions
        async function startAnalysis() {
            if (!selectedFile || analysisInProgress) {
                return;
            }
            
            analysisInProgress = true;
            analyzeBtn.disabled = true;
            startAnalysisBtn.disabled = true;
            
            processingTitle.textContent = 'AI Analysis in Progress';
            processingSubtitle.textContent = 'Analyzing your medical image using advanced AI algorithms...';
            
            // Simulate AI analysis with progress updates
            await simulateAnalysis();
            
            analysisInProgress = false;
            analyzeBtn.disabled = false;
            startAnalysisBtn.disabled = false;
        }

        async function simulateAnalysis() {
            const steps = [
                { progress: 15, status: 'Preprocessing image...', icon: 'fas fa-cog', title: 'Image Preprocessing', subtitle: 'Enhancing image quality and normalizing data...' },
                { progress: 35, status: 'Extracting features...', icon: 'fas fa-search', title: 'Feature Extraction', subtitle: 'Identifying key visual patterns and structures...' },
                { progress: 55, status: 'Running AI models...', icon: 'fas fa-brain', title: 'AI Model Analysis', subtitle: 'Deep learning model evaluation in progress...' },
                { progress: 75, status: 'Analyzing patterns...', icon: 'fas fa-chart-line', title: 'Pattern Analysis', subtitle: 'Analyzing medical patterns and anomalies...' },
                { progress: 90, status: 'Finalizing results...', icon: 'fas fa-clipboard-check', title: 'Finalizing Analysis', subtitle: 'Generating comprehensive analysis report...' },
                { progress: 100, status: 'Analysis complete!', icon: 'fas fa-check-circle', title: 'Analysis Complete', subtitle: 'AI analysis finished successfully!' }
            ];
            
            for (let step of steps) {
                await new Promise(resolve => setTimeout(resolve, isMobile() ? 1200 : 1500));
                
                // Update progress
                updateProgress(step.progress);
                
                // Update processing info
                processingTitle.textContent = step.title;
                processingSubtitle.textContent = step.subtitle;
                
                // Update status
                statusIndicators.innerHTML = `
                    <div class="status-item">
                        <i class="${step.icon}"></i>
                        <span>${step.status}</span>
                    </div>
                `;
            }
            
            // Show final results
            await new Promise(resolve => setTimeout(resolve, 500));
            showAnalysisResults();
        }

        function updateProgress(percentage) {
            progressText.textContent = `${percentage}%`;
            const degrees = (percentage / 100) * 360;
            progressCircle.style.background = `conic-gradient(#14b8a6 ${degrees}deg, #e2e8f0 ${degrees}deg)`;
            
            if (percentage === 100) {
                progressCircle.classList.add('processing-active');
                setTimeout(() => {
                    progressCircle.classList.remove('processing-active');
                }, 1000);
            }
        }

        function showAnalysisResults() {
            // Generate mock results
            const results = generateMockResults();
            
            overallResult.textContent = results.overall;
            overallResult.className = `result-value ${results.overallClass}`;
            
            confidenceResult.textContent = results.confidence;
            riskResult.textContent = results.risk;
            recommendationResult.textContent = results.recommendation;
            
            processingTitle.textContent = 'Analysis Complete';
            processingSubtitle.textContent = 'AI analysis has been completed. Review the results below.';
            
            const processingTime = Math.floor(Math.random() * 5) + 3;
            statusIndicators.innerHTML = `
                <div class="status-item">
                    <i class="fas fa-check-circle"></i>
                    <span>Analysis Complete</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-clock"></i>
                    <span>${processingTime}s</span>
                </div>
            `;
            
            showNotification('success', 'Analysis Complete', 'AI analysis completed successfully!');
        }

        function generateMockResults() {
            const outcomes = [
                {
                    overall: 'Normal',
                    overallClass: 'result-normal',
                    confidence: '94.2%',
                    risk: 'Low',
                    recommendation: 'Regular checkup recommended'
                },
                {
                    overall: 'Requires Attention',
                    overallClass: 'result-warning',
                    confidence: '87.5%',
                    risk: 'Medium',
                    recommendation: 'Consult specialist within 2 weeks'
                },
                {
                    overall: 'Abnormal',
                    overallClass: 'result-abnormal',
                    confidence: '91.8%',
                    risk: 'High',
                    recommendation: 'Immediate medical consultation required'
                }
            ];
            
            return outcomes[Math.floor(Math.random() * outcomes.length)];
        }

        // Message functions
        function showError(message) {
            document.getElementById('errorText').textContent = message;
            errorMessage.classList.add('show');
            successMessage.classList.remove('show');
            
            // Auto-hide after 5 seconds on mobile
            if (isMobile()) {
                setTimeout(() => {
                    errorMessage.classList.remove('show');
                }, 5000);
            }
        }

        function showSuccess(message) {
            document.getElementById('successText').textContent = message;
            successMessage.classList.add('show');
            errorMessage.classList.remove('show');
            
            // Auto-hide after 3 seconds on mobile
            if (isMobile()) {
                setTimeout(() => {
                    successMessage.classList.remove('show');
                }, 3000);
            }
        }

        function hideMessages() {
            errorMessage.classList.remove('show');
            successMessage.classList.remove('show');
        }

        // Notification functions
        function showNotification(type, title, message) {
            // Set icon based on type
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            notificationIcon.className = icons[type] || icons.info;
            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            
            // Remove existing type classes and add new one
            notification.classList.remove('error', 'warning', 'info');
            if (type !== 'success') {
                notification.classList.add(type);
            }
            
            notification.classList.add('show');
            
            // Auto-hide after appropriate time
            const hideTime = isMobile() ? (type === 'error' ? 5000 : 3000) : 4000;
            setTimeout(() => {
                notification.classList.remove('show');
            }, hideTime);
        }

        // Report functions
        function downloadReport() {
            showNotification('info', 'Download Started', 'Preparing your analysis report...');
            
            // Simulate download process
            setTimeout(() => {
                const reportData = {
                    patientId: 'AS-2025-001',
                    analysisDate: new Date().toLocaleString(),
                    fileName: selectedFile ? selectedFile.name : 'Unknown',
                    results: {
                        overall: overallResult.textContent,
                        confidence: confidenceResult.textContent,
                        risk: riskResult.textContent,
                        recommendation: recommendationResult.textContent
                    },
                    deviceInfo: {
                        userAgent: navigator.userAgent,
                        platform: navigator.platform,
                        isMobile: isMobile()
                    }
                };
                
                const dataStr = JSON.stringify(reportData, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `ArogyaSakhi_Report_${new Date().toISOString().split('T')[0]}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.style.display = 'none';
                document.body.appendChild(linkElement);
                linkElement.click();
                document.body.removeChild(linkElement);
                
                showNotification('success', 'Download Complete', 'Report downloaded successfully!');
            }, 1500);
        }

        function shareReport() {
            const reportText = `ArogyaSakhi Analysis Report\n\nPatient ID: AS-2025-001\nAnalysis Date: ${new Date().toLocaleString()}\n\nResults:\nOverall Assessment: ${overallResult.textContent}\nConfidence: ${confidenceResult.textContent}\nRisk Level: ${riskResult.textContent}\nRecommendation: ${recommendationResult.textContent}\n\nGenerated by ArogyaSakhi AI Healthcare Assistant`;
            
            if (navigator.share && isMobile()) {
                navigator.share({
                    title: 'ArogyaSakhi Analysis Report',
                    text: reportText,
                    url: window.location.href
                }).then(() => {
                    showNotification('success', 'Shared Successfully', 'Report has been shared!');
                }).catch((error) => {
                    if (error.name !== 'AbortError') {
                        fallbackShare(reportText);
                    }
                });
            } else {
                fallbackShare(reportText);
            }
        }

        function fallbackShare(reportText) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(reportText).then(() => {
                    showNotification('success', 'Copied to Clipboard', 'Report summary copied to clipboard!');
                }).catch(() => {
                    showNotification('warning', 'Share Not Available', 'Sharing not supported on this device.');
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = reportText;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    showNotification('success', 'Copied to Clipboard', 'Report summary copied to clipboard!');
                } catch (err) {
                    showNotification('warning', 'Copy Failed', 'Unable to copy report to clipboard.');
                }
                
                document.body.removeChild(textArea);
            }
        }

        // Performance optimization for mobile
        function optimizeForMobile() {
            if (isMobile()) {
                // Reduce animation duration for better performance
                document.documentElement.style.setProperty('--animation-duration', '0.2s');
                
                // Add hardware acceleration to key elements
                const animatedElements = [progressCircle, notification, cameraModal];
                animatedElements.forEach(el => {
                    if (el) {
                        el.style.willChange = 'transform, opacity';
                        el.style.transform = 'translateZ(0)';
                    }
                });
                
                // Optimize touch events
                document.body.style.touchAction = 'manipulation';
            }
        }

        // Error handling
        function handleGlobalError(error) {
            console.error('ArogyaSakhi Error:', error);
            showNotification('error', 'System Error', 'An unexpected error occurred. Please try again.');
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            try {
                initializeEventListeners();
                optimizeForMobile();
                
                // Show welcome notification after a delay
                setTimeout(() => {
                    const welcomeMessage = isMobile() 
                        ? 'Upload or capture a medical image to begin AI analysis.'
                        : 'Upload a medical image or use your camera to begin AI-powered analysis.';
                    showNotification('info', 'Welcome to ArogyaSakhi', welcomeMessage);
                }, 1000);
                
                // Add global error handler
                window.addEventListener('error', handleGlobalError);
                window.addEventListener('unhandledrejection', (event) => {
                    handleGlobalError(event.reason);
                });
                
            } catch (error) {
                handleGlobalError(error);
            }
        });

        // PWA-like features
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Note: Service worker registration would go here in a real implementation
                console.log('ArogyaSakhi: Ready for offline capabilities');
            });
        }

        // Handle app-like back button behavior on mobile
        if (isMobile()) {
            history.pushState(null, null, location.href);
            window.addEventListener('popstate', function(event) {
                if (cameraModal.classList.contains('show')) {
                    closeCamera();
                    history.pushState(null, null, location.href);
                } else if (mobileMenu.classList.contains('show')) {
                    closeMobileMenuHandler();
                    history.pushState(null, null, location.href);
                } else {
                    // Allow normal back navigation
                    history.back();
                }
            });
        }
    </script>
</body>
</html>